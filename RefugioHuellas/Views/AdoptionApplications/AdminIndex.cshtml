@model IEnumerable<RefugioHuellas.Models.ViewModels.AdminAdoptionVm>
@{
    ViewData["Title"] = "Solicitudes de adopción";
}

<h2>@ViewData["Title"]</h2>

@if (TempData["Ok"] != null)
{
    <div class="alert alert-success">@TempData["Ok"]</div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger">@TempData["Error"]</div>
}

<table class="table table-striped align-middle">
    <thead class="table-light">
        <tr>
            <th>Usuario</th>
            <th>Perro</th>
            <th>Compatibilidad</th>
            <th>Estado</th>
            <th>Fecha</th>
            <th class="text-end">Acciones</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var a in Model)
        {
            // Badge por compatibilidad
            var compatClass = a.CompatibilityScore switch
            {
                >= 75 => "bg-success text-white",
                >= 50 => "bg-warning text-dark",
                _ => "bg-danger text-white"
            };

            // Badge por estado
            var statusClass = a.Status == "Aprobada" ? "badge bg-success" :
            a.Status == "Rechazada" ? "badge bg-danger" :
            "badge bg-secondary";

            <tr>
                <td>@(a.UserEmail ?? a.UserId)</td>
                <td>@a.DogName</td>
                <td>
                    <span class="badge @compatClass">@a.CompatibilityScore %</span>
                </td>
                <td>
                    <span class="@statusClass">@a.Status</span>
                </td>
                <td>@a.CreatedAt.ToLocalTime().ToString("g")</td>
                <td class="text-end">
                    <a asp-action="AdminDetails"
                       asp-route-id="@a.Id"
                       class="btn btn-outline-primary btn-sm">
                        Ver
                    </a>
                </td>
            </tr>
        }
    </tbody>
</table>

<div class="mt-3">
    <small class="text-muted">
        La aprobación ahora se realiza desde <strong>Mejores Candidatos</strong> cuando cierre la ventana del perro.
    </small>
</div>
